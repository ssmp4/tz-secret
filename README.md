# Сервис "Одноразовые секреты"

Сервис для безопасного хранения и передачи конфиденциальных данных, которые могут быть прочитаны только один раз.

## Особенности

- Секреты хранятся в зашифрованном виде
- Каждый секрет может быть прочитан только один раз
- Поддержка времени жизни секрета (TTL)
- Опциональная защита паролем
- Кеширование в Redis
- Логирование всех операций в PostgreSQL
- Запрет кеширования на клиенте

## Требования

- Docker
- Docker Compose
- Python 3.11+

## Установка и запуск

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd tz-secret
```

2. Запустите сервис с помощью Docker Compose:
```bash
docker-compose up --build
```

Сервис будет доступен по адресу: http://localhost:8000

## API Документация

После запуска сервиса, документация API доступна по адресу:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

### Эндпоинты

#### Создание секрета
```
POST /secret
```

Тело запроса:
```json
{
  "secret": "ваш_секрет",
  "passphrase": "опциональный_пароль",
  "ttl_seconds": 3600
}
```

#### Получение секрета
```
GET /secret/{secret_key}
```

#### Удаление секрета
```
DELETE /secret/{secret_key}
```

## Структура проекта

```
tz-secret/
├── app/
│   ├── __init__.py
│   ├── main.py
│   ├── config.py
│   ├── database.py
│   ├── redis.py
│   ├── crypto.py
│   ├── models.py
│   ├── schemas.py
│   └── init_db.py
├── docker-compose.yml
├── Dockerfile
├── requirements.txt
└── README.md
```

## Безопасность

- Все секреты шифруются перед сохранением
- Используется безопасное хранение паролей (bcrypt)
- Запрещено кеширование на клиенте
- Все операции логируются
- Поддержка TTL для автоматического удаления старых секретов 